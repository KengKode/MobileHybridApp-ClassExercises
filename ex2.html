<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Exercise 2</title>
        <meta content="width=device-width, initial-scale=1" name="viewport">
        <link href="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.css" rel="stylesheet" />
        <script src="http://code.jquery.com/jquery-1.6.4.min.js"></script>
        <script src="http://code.jquery.com/mobile/1.1.0/jquery.mobile-1.1.0.min.js"></script>
    </head>

    <body>
        <div id="moviesPage" data-role="page">
            <div data-role="header"><h1>My Movies</h1></div>
            <div data-role="content">
                <div><button id="showMeButton">Show Me</button></div>
                <ul id="moviesList" data-inset="true" data-role="listview">
                    <li data-role="list-divider" data-theme="c">I'm disappering soon ...</li>
                </ul>
            </div>
        </div>
        <script>
            $('#moviesPage').bind('pageinit', function() {
                $('#showMeButton').bind('click', function() {
                    $.get('mymovies.json', {}, function(res, code) {
                        var moviesList = $('#moviesList');
                        moviesList.empty();
                        moviesList.append($('<li>').data('role', 'list-divider').append('Top List'));
                        var i;
                        var s = '';
                        for(i = 0; i < res.length; i++) {
                            s += '<li><a>' + res[i].name + '<span class="ui-li-count">' + res[i].year + '</span></a></li>';
                        }
                        moviesList.append(s);            
                        moviesList.listview('refresh', true);            
                    }, 'json');
                })
            })
        </script>
    </body>
</html>